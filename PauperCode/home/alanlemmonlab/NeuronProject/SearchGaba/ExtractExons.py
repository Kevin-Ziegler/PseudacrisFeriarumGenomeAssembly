#lst = [[['scaffold_389|arrow'], [[[85, 144], [1014346, 1014167], 100], [[145, 158], [1014166, 1014125], 100], [[364, 423], [887540, 887364], 92], [[424, 454], [887363, 887271], 92], [[282, 339], [926605, 926426], 97], [[340, 345], [926425, 926408], 97], [[231, 285], [947092, 946928], 95], [[231, 289], [1500108, 1499932], 83], [[285, 339], [1499083, 1498919], 87], [[187, 234], [983278, 983135], 96], [[155, 190], [989772, 989665], 83], [[58, 84], [1030532, 1030452], 89], [[60, 84], [1525005, 1524931], 76], [[41, 58], [1525291, 1525238], 94]]], [['scaffold_219|arrow'], [[[354, 413], [2356708, 2356529], 96], [[414, 451], [2356528, 2356415], 96], [[87, 146], [2459107, 2458928], 85], [[147, 172], [2458927, 2458850], 85], [[287, 346], [2363993, 2363814], 96], [[347, 358], [2363813, 2363778], 96], [[236, 287], [2407835, 2407680], 100], [[167, 226], [2411653, 2411474], 75], [[227, 237], [2411473, 2411441], 75], [[26, 67], [2558293, 2558168], 83], [[64, 86], [2490359, 2490291], 96]]], [['scaffold_462|arrow'], [[[163, 222], [234342, 234521], 96], [[223, 236], [234522, 234563], 96], [[363, 422], [599369, 599548], 97], [[423, 433], [599549, 599581], 97], [[435, 494], [657729, 657902], 84], [[495, 538], [657903, 658034], 84], [[312, 363], [483322, 483477], 100], [[265, 312], [369034, 369177], 90], [[100, 139], [68012, 68131], 93], [[240, 266], [267778, 267858], 93], [[138, 162], [153056, 153130], 92]]], [['scaffold_5705|arrow'], [[[92, 151], [4750, 4926], 86], [[152, 165], [4927, 4968], 86], [[292, 351], [33765, 33944], 86], [[352, 357], [33945, 33962], 86], [[240, 296], [27762, 27932], 91], [[165, 192], [8253, 8336], 89], [[194, 241], [23902, 24045], 81], [[69, 91], [812, 880], 96], [[41, 65], [499, 573], 76]]], [['scaffold_154|arrow'], [[[373, 431], [3831675, 3831851], 84], [[432, 475], [3831852, 3831983], 84], [[97, 156], [3647375, 3647554], 97], [[157, 170], [3647555, 3647596], 97], [[297, 356], [3823991, 3824170], 100], [[357, 357], [3824171, 3824173], 100], [[241, 297], [3771133, 3771303], 95], [[199, 247], [3747461, 3747607], 94], [[33, 75], [3610845, 3610973], 81], [[170, 197], [3710457, 3710540], 100], [[74, 96], [3646394, 3646462], 100]]], [['scaffold_5705|arrow'], [[[76, 135], [4750, 4926], 91], [[136, 149], [4927, 4968], 91], [[276, 333], [33765, 33938], 97], [[149, 176], [8253, 8336], 100], [[178, 225], [23902, 24045], 92], [[53, 75], [812, 880], 91]]]]
#lst = [[['scaffold_389|arrow'], [[[85, 144], [1014346, 1014167], 100], [[145, 158], [1014166, 1014125], 100], [[364, 423], [887540, 887364], 92], [[424, 454], [887363, 887271], 92], [[282, 339], [926605, 926426], 97], [[340, 345], [926425, 926408], 97], [[231, 285], [947092, 946928], 95], [[231, 289], [1500108, 1499932], 83], [[187, 234], [983278, 983135], 96], [[155, 190], [989772, 989665], 83], [[58, 84], [1030532, 1030452], 89], [[41, 58], [1525291, 1525238], 94]]], [['scaffold_219|arrow'], [[[354, 413], [2356708, 2356529], 96], [[414, 451], [2356528, 2356415], 96], [[87, 146], [2459107, 2458928], 85], [[147, 172], [2458927, 2458850], 85], [[287, 346], [2363993, 2363814], 96], [[347, 358], [2363813, 2363778], 96], [[236, 287], [2407835, 2407680], 100], [[167, 226], [2411653, 2411474], 75], [[227, 237], [2411473, 2411441], 75], [[26, 67], [2558293, 2558168], 83], [[64, 86], [2490359, 2490291], 96]]], [['scaffold_462|arrow'], [[[163, 222], [234342, 234521], 96], [[223, 236], [234522, 234563], 96], [[363, 422], [599369, 599548], 97], [[423, 433], [599549, 599581], 97], [[435, 494], [657729, 657902], 84], [[495, 538], [657903, 658034], 84], [[312, 363], [483322, 483477], 100], [[265, 312], [369034, 369177], 90], [[100, 139], [68012, 68131], 93], [[240, 266], [267778, 267858], 93], [[138, 162], [153056, 153130], 92]]], [['scaffold_5705|arrow'], [[[92, 151], [4750, 4926], 86], [[152, 165], [4927, 4968], 86], [[292, 351], [33765, 33944], 86], [[352, 357], [33945, 33962], 86], [[240, 296], [27762, 27932], 91], [[165, 192], [8253, 8336], 89], [[194, 241], [23902, 24045], 81], [[69, 91], [812, 880], 96], [[41, 65], [499, 573], 76]]], [['scaffold_154|arrow'], [[[373, 431], [3831675, 3831851], 84], [[432, 475], [3831852, 3831983], 84], [[97, 156], [3647375, 3647554], 97], [[157, 170], [3647555, 3647596], 97], [[297, 356], [3823991, 3824170], 100], [[357, 357], [3824171, 3824173], 100], [[241, 297], [3771133, 3771303], 95], [[199, 247], [3747461, 3747607], 94], [[33, 75], [3610845, 3610973], 81], [[170, 197], [3710457, 3710540], 100], [[74, 96], [3646394, 3646462], 100]]], [['scaffold_5705|arrow'], [[[76, 135], [4750, 4926], 91], [[136, 149], [4927, 4968], 91], [[276, 333], [33765, 33938], 97], [[149, 176], [8253, 8336], 100], [[178, 225], [23902, 24045], 92], [[53, 75], [812, 880], 91]]]]
#lst = [[['scaffold_389|arrow'], [[[85, 144], [1014346, 1014167], 100], [[145, 158], [1014166, 1014125], 100], [[364, 423], [887540, 887364], 92], [[424, 454], [887363, 887271], 92], [[282, 339], [926605, 926426], 97], [[340, 345], [926425, 926408], 97], [[231, 285], [947092, 946928], 95], [[231, 289], [1500108, 1499932], 83], [[187, 234], [983278, 983135], 96], [[155, 190], [989772, 989665], 83], [[58, 84], [1030532, 1030452], 89], [[41, 58], [1525291, 1525238], 94]]], [['scaffold_219|arrow'], [[[354, 413], [2356708, 2356529], 96], [[414, 451], [2356528, 2356415], 96], [[87, 146], [2459107, 2458928], 85], [[147, 172], [2458927, 2458850], 85], [[287, 346], [2363993, 2363814], 96], [[347, 358], [2363813, 2363778], 96], [[236, 287], [2407835, 2407680], 100], [[167, 226], [2411653, 2411474], 75], [[227, 237], [2411473, 2411441], 75], [[26, 67], [2558293, 2558168], 83], [[64, 86], [2490359, 2490291], 96]]], [['scaffold_462|arrow'], [[[163, 222], [234342, 234521], 96], [[223, 236], [234522, 234563], 96], [[363, 422], [599369, 599548], 97], [[423, 433], [599549, 599581], 97], [[435, 494], [657729, 657902], 84], [[495, 538], [657903, 658034], 84], [[312, 363], [483322, 483477], 100], [[265, 312], [369034, 369177], 90], [[100, 139], [68012, 68131], 93], [[240, 266], [267778, 267858], 93], [[138, 162], [153056, 153130], 92]]], [['scaffold_5705|arrow'], [[[92, 151], [4750, 4926], 86], [[152, 165], [4927, 4968], 86], [[292, 351], [33765, 33944], 86], [[352, 357], [33945, 33962], 86], [[240, 296], [27762, 27932], 91], [[165, 192], [8253, 8336], 89], [[194, 241], [23902, 24045], 81], [[69, 91], [812, 880], 96], [[41, 65], [499, 573], 76]]], [['scaffold_154|arrow'], [[[373, 431], [3831675, 3831851], 84], [[432, 475], [3831852, 3831983], 84], [[97, 156], [3647375, 3647554], 97], [[157, 170], [3647555, 3647596], 97], [[297, 356], [3823991, 3824170], 100], [[357, 357], [3824171, 3824173], 100], [[241, 297], [3771133, 3771303], 95], [[199, 247], [3747461, 3747607], 94], [[33, 75], [3610845, 3610973], 81], [[170, 197], [3710457, 3710540], 100], [[74, 96], [3646394, 3646462], 100]]], [['scaffold_5705|arrow'], [[[76, 135], [4750, 4926], 91], [[136, 149], [4927, 4968], 91], [[276, 333], [33765, 33938], 97], [[149, 176], [8253, 8336], 100], [[178, 225], [23902, 24045], 92], [[53, 75], [812, 880], 91]]]]
#lst = [[['scaffold_389|arrow'], [[[85, 144], [1014346, 1014167], 100], [[145, 158], [1014166, 1014125], 100], [[364, 423], [887540, 887364], 92], [[424, 454], [887363, 887271], 92], [[282, 339], [926605, 926426], 97], [[340, 345], [926425, 926408], 97], [[231, 285], [947092, 946928], 95], [[187, 234], [983278, 983135], 96], [[155, 190], [989772, 989665], 83], [[58, 84], [1030532, 1030452], 89], [[41, 58], [1525291, 1525238], 94]]], [['scaffold_219|arrow'], [[[354, 413], [2356708, 2356529], 96], [[414, 451], [2356528, 2356415], 96], [[87, 146], [2459107, 2458928], 85], [[147, 172], [2458927, 2458850], 85], [[287, 346], [2363993, 2363814], 96], [[347, 358], [2363813, 2363778], 96], [[236, 287], [2407835, 2407680], 100], [[167, 226], [2411653, 2411474], 75], [[227, 237], [2411473, 2411441], 75], [[26, 67], [2558293, 2558168], 83], [[64, 86], [2490359, 2490291], 96]]], [['scaffold_462|arrow'], [[[163, 222], [234342, 234521], 96], [[223, 236], [234522, 234563], 96], [[363, 422], [599369, 599548], 97], [[423, 433], [599549, 599581], 97], [[435, 494], [657729, 657902], 84], [[495, 538], [657903, 658034], 84], [[312, 363], [483322, 483477], 100], [[265, 312], [369034, 369177], 90], [[100, 139], [68012, 68131], 93], [[240, 266], [267778, 267858], 93], [[138, 162], [153056, 153130], 92]]], [['scaffold_5705|arrow'], [[[92, 151], [4750, 4926], 86], [[152, 165], [4927, 4968], 86], [[292, 351], [33765, 33944], 86], [[352, 357], [33945, 33962], 86], [[240, 296], [27762, 27932], 91], [[165, 192], [8253, 8336], 89], [[194, 241], [23902, 24045], 81], [[69, 91], [812, 880], 96], [[41, 65], [499, 573], 76]]], [['scaffold_154|arrow'], [[[373, 431], [3831675, 3831851], 84], [[432, 475], [3831852, 3831983], 84], [[97, 156], [3647375, 3647554], 97], [[157, 170], [3647555, 3647596], 97], [[297, 356], [3823991, 3824170], 100], [[357, 357], [3824171, 3824173], 100], [[241, 297], [3771133, 3771303], 95], [[199, 247], [3747461, 3747607], 94], [[33, 75], [3610845, 3610973], 81], [[170, 197], [3710457, 3710540], 100], [[74, 96], [3646394, 3646462], 100]]], [['scaffold_5705|arrow'], [[[76, 135], [4750, 4926], 91], [[136, 149], [4927, 4968], 91], [[276, 333], [33765, 33938], 97], [[149, 176], [8253, 8336], 100], [[178, 225], [23902, 24045], 92], [[53, 75], [812, 880], 91]]]]

#lst = [[['scaffold_389|arrow'], [[[85, 144], [1014346, 1014167], 100], [[145, 158], [1014166, 1014125], 100], [[364, 423], [887540, 887364], 92], [[424, 454], [887363, 887271], 92], [[282, 339], [926605, 926426], 97], [[340, 345], [926425, 926408], 97], [[231, 285], [947092, 946928], 95], [[187, 234], [983278, 983135], 96], [[155, 190], [989772, 989665], 83], [[58, 84], [1030532, 1030452], 89], [[41, 58], [1525291, 1525238], 94]]], [['scaffold_219|arrow'], [[[354, 413], [2356708, 2356529], 96], [[414, 451], [2356528, 2356415], 96], [[87, 146], [2459107, 2458928], 85], [[147, 172], [2458927, 2458850], 85], [[287, 346], [2363993, 2363814], 96], [[347, 358], [2363813, 2363778], 96], [[236, 287], [2407835, 2407680], 100], [[167, 226], [2411653, 2411474], 75], [[227, 237], [2411473, 2411441], 75], [[26, 67], [2558293, 2558168], 83], [[64, 86], [2490359, 2490291], 96]]], [['scaffold_462|arrow'], [[[163, 222], [234342, 234521], 96], [[223, 236], [234522, 234563], 96], [[363, 422], [599369, 599548], 97], [[423, 433], [599549, 599581], 97], [[435, 494], [657729, 657902], 84], [[495, 538], [657903, 658034], 84], [[312, 363], [483322, 483477], 100], [[265, 312], [369034, 369177], 90], [[100, 139], [68012, 68131], 93], [[240, 266], [267778, 267858], 93], [[138, 162], [153056, 153130], 92]]], [['scaffold_5705|arrow'], [[[92, 151], [4750, 4926], 86], [[152, 165], [4927, 4968], 86], [[292, 351], [33765, 33944], 86], [[352, 357], [33945, 33962], 86], [[240, 296], [27762, 27932], 91], [[165, 192], [8253, 8336], 89], [[194, 241], [23902, 24045], 81], [[69, 91], [812, 880], 96], [[41, 65], [499, 573], 76]]], [['scaffold_154|arrow'], [[[373, 431], [3831675, 3831851], 84], [[432, 475], [3831852, 3831983], 84], [[97, 156], [3647375, 3647554], 97], [[157, 170], [3647555, 3647596], 97], [[297, 356], [3823991, 3824170], 100], [[357, 357], [3824171, 3824173], 100], [[241, 297], [3771133, 3771303], 95], [[199, 247], [3747461, 3747607], 94], [[33, 75], [3610845, 3610973], 81], [[170, 197], [3710457, 3710540], 100], [[74, 96], [3646394, 3646462], 100]]], [['scaffold_5705|arrow'], [[[76, 135], [4750, 4926], 91], [[136, 149], [4927, 4968], 91], [[276, 333], [33765, 33938], 97], [[149, 176], [8253, 8336], 100], [[178, 225], [23902, 24045], 92], [[53, 75], [812, 880], 91]]]]
#lst = [[['scaffold_389|arrow'], [[[85, 144], [1014346, 1014167], 100], [[145, 158], [1014166, 1014125], 100], [[364, 423], [887540, 887364], 92], [[424, 454], [887363, 887271], 92], [[282, 339], [926605, 926426], 97], [[340, 345], [926425, 926408], 97], [[231, 285], [947092, 946928], 95], [[187, 234], [983278, 983135], 96], [[41, 58], [1525291, 1525238], 94], [[155, 190], [989772, 989665], 83], [[58, 84], [1030532, 1030452], 89]]], [['scaffold_219|arrow'], [[[354, 413], [2356708, 2356529], 96], [[414, 451], [2356528, 2356415], 96], [[87, 146], [2459107, 2458928], 85], [[147, 172], [2458927, 2458850], 85], [[287, 346], [2363993, 2363814], 96], [[347, 358], [2363813, 2363778], 96], [[236, 287], [2407835, 2407680], 100], [[167, 226], [2411653, 2411474], 75], [[227, 237], [2411473, 2411441], 75], [[26, 67], [2558293, 2558168], 83], [[64, 86], [2490359, 2490291], 96]]], [['scaffold_462|arrow'], [[[163, 222], [234342, 234521], 96], [[223, 236], [234522, 234563], 96], [[363, 422], [599369, 599548], 97], [[423, 433], [599549, 599581], 97], [[435, 494], [657729, 657902], 84], [[495, 538], [657903, 658034], 84], [[312, 363], [483322, 483477], 100], [[265, 312], [369034, 369177], 90], [[100, 139], [68012, 68131], 93], [[240, 266], [267778, 267858], 93], [[138, 162], [153056, 153130], 92]]], [['scaffold_5705|arrow'], [[[92, 151], [4750, 4926], 86], [[152, 165], [4927, 4968], 86], [[292, 351], [33765, 33944], 86], [[352, 357], [33945, 33962], 86], [[240, 296], [27762, 27932], 91], [[165, 192], [8253, 8336], 89], [[194, 241], [23902, 24045], 81], [[69, 91], [812, 880], 96], [[41, 65], [499, 573], 76]]], [['scaffold_154|arrow'], [[[373, 431], [3831675, 3831851], 84], [[432, 475], [3831852, 3831983], 84], [[97, 156], [3647375, 3647554], 97], [[157, 170], [3647555, 3647596], 97], [[297, 356], [3823991, 3824170], 100], [[357, 357], [3824171, 3824173], 100], [[241, 297], [3771133, 3771303], 95], [[199, 247], [3747461, 3747607], 94], [[33, 75], [3610845, 3610973], 81], [[170, 197], [3710457, 3710540], 100], [[74, 96], [3646394, 3646462], 100]]], [['scaffold_5705|arrow'], [[[76, 135], [4750, 4926], 91], [[136, 149], [4927, 4968], 91], [[276, 333], [33765, 33938], 97], [[149, 176], [8253, 8336], 100], [[178, 225], [23902, 24045], 92], [[53, 75], [812, 880], 91]]]]

#lst = [[['scaffold_389|arrow'], [[[85, 144], [1014346, 1014167], 100, '159'], [[145, 158], [1014166, 1014125], 100, '159'], [[364, 423], [887540, 887364], 92, '133'], [[424, 454], [887363, 887271], 92, '133'], [[282, 339], [926605, 926426], 97, '126'], [[340, 345], [926425, 926408], 97, '126'], [[231, 285], [947092, 946928], 95, '111'], [[187, 234], [983278, 983135], 96, '93.2'], [[16, 61], [1064693, 1064556], 74, '80.5'], [[155, 190], [989772, 989665], 83, '71.6'], [[58, 84], [1030532, 1030452], 89, '52.8']]], [['scaffold_219|arrow'], [[[354, 413], [2356708, 2356529], 96, '160'], [[414, 451], [2356528, 2356415], 96, '160'], [[87, 146], [2459107, 2458928], 85, '155'], [[147, 172], [2458927, 2458850], 85, '155'], [[287, 346], [2363993, 2363814], 96, '123'], [[347, 358], [2363813, 2363778], 96, '123'], [[236, 287], [2407835, 2407680], 100, '112'], [[167, 226], [2411653, 2411474], 75, '104'], [[227, 237], [2411473, 2411441], 75, '104'], [[26, 67], [2558293, 2558168], 83, '74.3'], [[64, 86], [2490359, 2490291], 96, '49.7']]], [['scaffold_462|arrow'], [[[163, 222], [234342, 234521], 96, '150'], [[223, 236], [234522, 234563], 96, '150'], [[363, 422], [599369, 599548], 97, '146'], [[423, 433], [599549, 599581], 97, '146'], [[435, 494], [657729, 657902], 84, '142'], [[495, 538], [657903, 658034], 84, '142'], [[312, 363], [483322, 483477], 100, '112'], [[265, 312], [369034, 369177], 90, '92.0'], [[100, 139], [68012, 68131], 93, '80.5'], [[240, 266], [267778, 267858], 93, '59.3'], [[138, 162], [153056, 153130], 92, '48.1']]], [['scaffold_5705|arrow'], [[[92, 151], [4750, 4926], 86, '142'], [[152, 165], [4927, 4968], 86, '142'], [[292, 351], [33765, 33944], 86, '117'], [[352, 357], [33945, 33962], 86, '117'], [[240, 296], [27762, 27932], 91, '113'], [[524, 559], [41003, 41110], 72, '63.5'], [[165, 192], [8253, 8336], 89, '62.8'], [[194, 241], [23902, 24045], 81, '60.1'], [[69, 91], [812, 880], 96, '46.2'], [[41, 65], [499, 573], 76, '43.9']]], [['scaffold_154|arrow'], [[[373, 431], [3831675, 3831851], 84, '175'], [[432, 475], [3831852, 3831983], 84, '175'], [[97, 156], [3647375, 3647554], 97, '155'], [[157, 170], [3647555, 3647596], 97, '155'], [[297, 356], [3823991, 3824170], 100, '128'], [[357, 357], [3824171, 3824173], 100, '128'], [[241, 297], [3771133, 3771303], 95, '115'], [[199, 247], [3747461, 3747607], 94, '99.0'], [[33, 75], [3610845, 3610973], 81, '75.9'], [[170, 197], [3710457, 3710540], 100, '65.5'], [[74, 96], [3646394, 3646462], 100, '49.7']]], [['scaffold_5705|arrow'], [[[76, 135], [4750, 4926], 91, '147'], [[136, 149], [4927, 4968], 91, '147'], [[276, 333], [33765, 33938], 97, '116'], [[221, 280], [27753, 27932], 70, '90.5'], [[149, 176], [8253, 8336], 100, '66.6'], [[178, 225], [23902, 24045], 92, '59.3'], [[53, 75], [812, 880], 91, '44.7']]]]

lst = [[['scaffold_389|arrow'], [[[85, 144], [1014346, 1014167], 100, 159.0], [[145, 158], [1014166, 1014125], 100, 159.0], [[364, 423], [887540, 887364], 92, 133.0], [[424, 454], [887363, 887271], 92, 133.0], [[282, 339], [926605, 926426], 97, 126.0], [[340, 345], [926425, 926408], 97, 126.0], [[231, 285], [947092, 946928], 95, 111.0], [[187, 234], [983278, 983135], 96, 93.2], [[16, 61], [1064693, 1064556], 74, 80.5], [[155, 190], [989772, 989665], 83, 71.6], [[58, 84], [1030532, 1030452], 89, 52.8]]], [['scaffold_219|arrow'], [[[354, 413], [2356708, 2356529], 96, 160.0], [[414, 451], [2356528, 2356415], 96, 160.0], [[87, 146], [2459107, 2458928], 85, 155.0], [[147, 172], [2458927, 2458850], 85, 155.0], [[287, 346], [2363993, 2363814], 96, 123.0], [[347, 358], [2363813, 2363778], 96, 123.0], [[236, 287], [2407835, 2407680], 100, 112.0], [[167, 226], [2411653, 2411474], 75, 104.0], [[227, 237], [2411473, 2411441], 75, 104.0], [[26, 67], [2558293, 2558168], 83, 74.3], [[64, 86], [2490359, 2490291], 96, 49.7]]], [['scaffold_462|arrow'], [[[163, 222], [234342, 234521], 96, 150.0], [[223, 236], [234522, 234563], 96, 150.0], [[363, 422], [599369, 599548], 97, 146.0], [[423, 433], [599549, 599581], 97, 146.0], [[435, 494], [657729, 657902], 84, 142.0], [[495, 538], [657903, 658034], 84, 142.0], [[312, 363], [483322, 483477], 100, 112.0], [[265, 312], [369034, 369177], 90, 92.0], [[100, 139], [68012, 68131], 93, 80.5], [[240, 266], [267778, 267858], 93, 59.3], [[138, 162], [153056, 153130], 92, 48.1]]], [['scaffold_5705|arrow'], [[[92, 151], [4750, 4926], 86, 142.0], [[152, 165], [4927, 4968], 86, 142.0], [[292, 351], [33765, 33944], 86, 117.0], [[352, 357], [33945, 33962], 86, 117.0], [[240, 296], [27762, 27932], 91, 113.0], [[524, 559], [41003, 41110], 72, 63.5], [[165, 192], [8253, 8336], 89, 62.8], [[194, 241], [23902, 24045], 81, 60.1], [[69, 91], [812, 880], 96, 46.2], [[41, 65], [499, 573], 76, 43.9]]], [['scaffold_154|arrow'], [[[373, 431], [3831675, 3831851], 84, 175.0], [[432, 475], [3831852, 3831983], 84, 175.0], [[97, 156], [3647375, 3647554], 97, 155.0], [[157, 170], [3647555, 3647596], 97, 155.0], [[297, 356], [3823991, 3824170], 100, 128.0], [[357, 357], [3824171, 3824173], 100, 128.0], [[241, 297], [3771133, 3771303], 95, 115.0], [[199, 247], [3747461, 3747607], 94, 99.0], [[33, 75], [3610845, 3610973], 81, 75.9], [[170, 197], [3710457, 3710540], 100, 65.5], [[74, 96], [3646394, 3646462], 100, 49.7]]], [['scaffold_5705|arrow'], [[[76, 135], [4750, 4926], 91, 147.0], [[136, 149], [4927, 4968], 91, 147.0], [[276, 333], [33765, 33938], 97, 116.0], [[221, 280], [27753, 27932], 70, 90.5], [[149, 176], [8253, 8336], 100, 66.6], [[178, 225], [23902, 24045], 92, 59.3], [[53, 75], [812, 880], 91, 44.7]]]]

lst = [lst[0], lst[1], lst[2], lst[4], lst[5]]

#lst = [lst[1]]

fileGenome = "/home/alanlemmonlab/NeuronProject/Data/PferAssemblies/myConsensus_Arrow_3_20_2023.fasta"

f = open(fileGenome, 'r')

lstScaffolds = []
lstScaffoldStartStop = []
lstRef = []
lstExons = []
lstOrder = []

for i in range(0, len(lst)):
	lstScaffolds.append(lst[i][0][0])
	min = 999999999999999999999999
	max = -1

	for j in range(0, len(lst[i][1])):

		qstart = lst[i][1][j][1][0]
		qstop = lst[i][1][j][1][1]
		if qstop > max:
			max = qstop
		if qstart < min:
			min = qstart
	temp = [min,max]
	print(max-min)
	lstScaffoldStartStop.append(temp)

print(lstScaffolds)
print(lstScaffoldStartStop)

currentScaffold = ""
currentSeq = ""
flagIn = 0


for line in f:
	if len(line) > 1:
		if line[0] == ">":
			#print(currentScaffold)

			#if "scaffold_389|arrow" in lstScaffolds:
			#	print("what")

			if line[1:-1] in lstScaffolds:
				print("In")
				flagIn = 1
			else:
				flagIn = 0

			if currentScaffold in lstScaffolds:
				print(currentScaffold)
				#print(currentSeq)
				index = lstScaffolds.index(currentScaffold)
				print(index)
				print(lstScaffoldStartStop[index][0]-1)
				print(lstScaffoldStartStop[index][1]-1)

				ref = currentSeq[lstScaffoldStartStop[index][0]-1:lstScaffoldStartStop[index][1]-1]
				lstRef.append(ref)
				myRefWithExons = ["-"]*len(currentSeq)
				print(len(currentSeq))
				print(len(myRefWithExons))
				print(myRefWithExons[0:10])
				print(len(ref))
				for i in range(0, len(lst[index][1])):
					start = lst[index][1][i][1][0]
					stop = lst[index][1][i][1][1]
					print(start, stop)
					print(currentSeq[start:stop])
					min = start
					max = stop
					if stop < start:
						min = stop
						max = start
					for j in range(min-1, max-1):
						lol = currentSeq[j]
						#print(lol)
						myRefWithExons[j] = lol
				#print(myRefWithExons)
				myRefWithExons_W = myRefWithExons[lstScaffoldStartStop[index][0]-1:lstScaffoldStartStop[index][1]-1]
				#print(myRefWithExons_W)
				flat = ""
				for i in range(0, len(myRefWithExons_W)):
					flat = flat + myRefWithExons_W[i]
				lstExons.append(flat)
				lstOrder.append(currentScaffold)

			currentScaffold = line[1:-1]
			#lstOrder.append(currentScaffold)
			currentSeq = ""

		elif flagIn == 1:
			currentSeq = currentSeq + line[:-1]

f.close()

#print(lstRef)
#print(lstExons)

for j in range(0, len(lstRef)):
	i = j
	if i > 2:
		i+=1
	fileOut = open("Pfer_GABARA_alpha_" + str(i+1) + "_Exons.fasta", 'w')
	fileOut.write(">" + lstOrder[j] + "_Gene \n")
	fileOut.write(lstRef[j] + " \n")
	fileOut.write(">" + lstOrder[j] + "_Exons \n")
	fileOut.write(lstExons[j] + " \n")
	fileOut.close()
